 ‚úì Starting...
 ‚úì Ready in 1227ms
 ‚óã Compiling / ...
 ‚úì Compiled / in 2.9s (616 modules)
 GET / 200 in 3129ms
 ‚óã Compiling /favicon.ico ...
 ‚úì Compiled /favicon.ico in 1060ms (610 modules)
 ‚úì Compiled in 1ms (338 modules)
 ‚úì Compiled in 976ms (625 modules)
 GET /favicon.ico 200 in 2013ms
 GET /.well-known/appspecific/com.chrome.devtools.json 404 in 2221ms
 ‚óã Compiling /map ...
 ‚úì Compiled /map in 61.1s (12644 modules)
 ‚óã Compiling /middleware ...
 ‚úì Compiled /middleware in 1848ms (72 modules)
 ‚óã Compiling /api/claude/generate-response ...
 ‚úì Compiled /api/claude/generate-response in 3.8s (6473 modules)
[Claude] POST request received
[Claude] API key is present, length: 108
[Claude] Parsing JSON request (Chat)
[Claude] JSON request body parsed successfully
[Claude] Messages count: 1
[Claude] Has featureData: true
[Claude] Persona: strategist
[CONTEXTUAL CHAT] Optimized follow-up question processing
üéØ [CLAUDE API] Received ranking context: undefined
üö® [CLAUDE API CALLED] Route accessed with metadata keys: [ 'query', 'analysisType', 'relevantLayers', 'isContextualChat' ]
üö® [CLAUDE API] Query/message: Provide a comprehensive analysis of the brand difference results
üö® [CLAUDE API] FeatureData type: object array
[GeoDataManager] Initializing comprehensive Florida geographic database...
[GeoDataManager] Aggregating ZIP codes for counties, metros, and state...
[GeoDataManager] ZIP code mappings created: { cities: 378, counties: 378, metros: 272, state: 378 }
[GeoDataManager] Comprehensive Florida database initialized with 32 entities
[GeoAwarenessEngine] Loaded Phase 1 multi-level geographic data: {
  entities: 32,
  zipToCity: 378,
  zipToCounty: 378,
  zipToMetro: 272,
  zipToState: 378,
  aliases: 73
}
[GeoAwarenessEngine] Processing geo query: Provide a comprehensive analysis of the brand difference results
üîç [GEO DEBUG] Parsing query: "Provide a comprehensive analysis of the brand difference results"
üö´ [GEO DEBUG] Query lacks explicit geographic intent - skipping geographic filtering
[Claude] Field alias overrides: {}
[Claude] Received POST request
[Claude] Metadata: {
  query: 'Analyze the brand difference results',
  analysisType: 'brand_difference',
  relevantLayers: [ 'unified_analysis' ],
  isContextualChat: true
}
[Claude] Persona: strategist
üéØ [CHAT STEP 1] Using fast-path data processing
[CONTEXTUAL CHAT] Processed lightweight feature data: 1 layers
[Claude] Processing 1 layers
[Claude] Layer 0: unified_analysis (50 features)
[Claude] Mapping featureData.features to processedLayersData...
[Claude] Processed 1 layers
[Claude DEBUG] First layer: unified_analysis with 50 features
[getRelevantFields] No specific fields found, returning all available fields
[Claude DEBUG] Determined primaryAnalysisField: ID
[Claude Prompt Gen] Using primary analysis field: ID
[Claude Prompt Gen] Starting to prepare data summary for prompt...
[Claude API] No new clustering detected, using legacy cluster information generation
[generateClusterInformation] Processing features to identify clusters with primary field: ID
[generateClusterInformation] Identified 12 top features (top 25% by value)
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: false,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: []
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: false,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: []
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: false,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: []
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: false,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: []
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: false,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: []
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: false,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: []
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: false,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: []
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: false,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: []
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: false,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: []
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: false,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: []
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: false,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: []
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: false,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: []
}
[generateClusterInformation] No valid clusters found with 5+ members
üîç [LAYER PROCESSING] Processing layer unified_analysis: {
  featureCount: 50,
  hasFeatures: true,
  firstFeatureId: undefined,
  spatialFilterActive: false
}
[Claude Prompt Gen] Added header for layer Analysis Results to summary. Sampled: false
[DEBUG Nike/Adidas] Layer Analysis Results: Nike field found: undefined, Adidas field found: undefined
[Claude Prompt Gen] Layer Analysis Results: Found 50 valid numeric values for ID.
[Claude Prompt Gen] Added stats for ID to summary.
[Claude Prompt Gen] Sorted 50 features for layer Analysis Results by ID.
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[getZIPCode DEBUG] Feature structure: {
  hasProperties: true,
  hasAttributes: true,
  propertiesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ],
  attributesKeys: [ 'ID', 'DESCRIPTION', 'OBJECTID', 'MP10104A_B', 'MP10104A_B_P' ]
}
[Claude Prompt Gen] Extracted top 50 features for layer Analysis Results.
üîç [Regular Processing] 32102 (Astor):
   currentLayerPrimaryField: ID
   tf.value: 32102
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 32102 > 10 but not capped (field: ID)
üîç [Regular Processing] 32815 (Orlando):
   currentLayerPrimaryField: ID
   tf.value: 32815
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 32815 > 10 but not capped (field: ID)
üîç [Regular Processing] 32094 (Wellborn):
   currentLayerPrimaryField: ID
   tf.value: 32094
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 32094 > 10 but not capped (field: ID)
üîç [Regular Processing] 32399 (Tallahassee):
   currentLayerPrimaryField: ID
   tf.value: 32399
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 32399 > 10 but not capped (field: ID)
üîç [Regular Processing] 32360 (Telogia):
   currentLayerPrimaryField: ID
   tf.value: 32360
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 32360 > 10 but not capped (field: ID)
üîç [Regular Processing] 33388 (Plantation):
   currentLayerPrimaryField: ID
   tf.value: 33388
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33388 > 10 but not capped (field: ID)
üîç [Regular Processing] 34478 (Ocala):
   currentLayerPrimaryField: ID
   tf.value: 34478
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 34478 > 10 but not capped (field: ID)
üîç [Regular Processing] 32204 (Jacksonville):
   currentLayerPrimaryField: ID
   tf.value: 32204
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 32204 > 10 but not capped (field: ID)
üîç [Regular Processing] 33199 (Miami):
   currentLayerPrimaryField: ID
   tf.value: 33199
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33199 > 10 but not capped (field: ID)
üîç [Regular Processing] 32530 (Bagdad):
   currentLayerPrimaryField: ID
   tf.value: 32530
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 32530 > 10 but not capped (field: ID)
üîç [Regular Processing] 32119 (Daytona Beach):
   currentLayerPrimaryField: ID
   tf.value: 32119
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 32119 > 10 but not capped (field: ID)
üîç [Regular Processing] 34785 (Wildwood):
   currentLayerPrimaryField: ID
   tf.value: 34785
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 34785 > 10 but not capped (field: ID)
üîç [Regular Processing] 32512 (Pensacola):
   currentLayerPrimaryField: ID
   tf.value: 32512
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 32512 > 10 but not capped (field: ID)
üîç [Regular Processing] 33039 (Homestead):
   currentLayerPrimaryField: ID
   tf.value: 33039
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33039 > 10 but not capped (field: ID)
üîç [Regular Processing] 33161 (Miami):
   currentLayerPrimaryField: ID
   tf.value: 33161
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33161 > 10 but not capped (field: ID)
üîç [Regular Processing] 33150 (Miami):
   currentLayerPrimaryField: ID
   tf.value: 33150
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33150 > 10 but not capped (field: ID)
üîç [Regular Processing] 34141 (Ochopee):
   currentLayerPrimaryField: ID
   tf.value: 34141
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 34141 > 10 but not capped (field: ID)
üîç [Regular Processing] 32952 (Merritt Island):
   currentLayerPrimaryField: ID
   tf.value: 32952
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 32952 > 10 but not capped (field: ID)
üîç [Regular Processing] 34434 (Dunnellon):
   currentLayerPrimaryField: ID
   tf.value: 34434
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 34434 > 10 but not capped (field: ID)
üîç [Regular Processing] 32162 (The Villages):
   currentLayerPrimaryField: ID
   tf.value: 32162
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 32162 > 10 but not capped (field: ID)
üîç [Regular Processing] 34445 (Holder):
   currentLayerPrimaryField: ID
   tf.value: 34445
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 34445 > 10 but not capped (field: ID)
üîç [Regular Processing] 33127 (Miami):
   currentLayerPrimaryField: ID
   tf.value: 33127
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33127 > 10 but not capped (field: ID)
üîç [Regular Processing] 32962 (Vero Beach):
   currentLayerPrimaryField: ID
   tf.value: 32962
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 32962 > 10 but not capped (field: ID)
üîç [Regular Processing] 33493 (South Bay):
   currentLayerPrimaryField: ID
   tf.value: 33493
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33493 > 10 but not capped (field: ID)
üîç [Regular Processing] 33128 (Miami):
   currentLayerPrimaryField: ID
   tf.value: 33128
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33128 > 10 but not capped (field: ID)
üîç [Regular Processing] 33406 (West Palm Beach):
   currentLayerPrimaryField: ID
   tf.value: 33406
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33406 > 10 but not capped (field: ID)
üîç [Regular Processing] 33125 (Miami):
   currentLayerPrimaryField: ID
   tf.value: 33125
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33125 > 10 but not capped (field: ID)
üîç [Regular Processing] 32209 (Jacksonville):
   currentLayerPrimaryField: ID
   tf.value: 32209
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 32209 > 10 but not capped (field: ID)
üîç [Regular Processing] 33430 (Belle Glade):
   currentLayerPrimaryField: ID
   tf.value: 33430
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33430 > 10 but not capped (field: ID)
üîç [Regular Processing] 32202 (Jacksonville):
   currentLayerPrimaryField: ID
   tf.value: 32202
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 32202 > 10 but not capped (field: ID)
üîç [Regular Processing] 33973 (Lehigh Acres):
   currentLayerPrimaryField: ID
   tf.value: 33973
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33973 > 10 but not capped (field: ID)
üîç [Regular Processing] 33142 (Miami):
   currentLayerPrimaryField: ID
   tf.value: 33142
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33142 > 10 but not capped (field: ID)
üîç [Regular Processing] 33158 (Miami):
   currentLayerPrimaryField: ID
   tf.value: 33158
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33158 > 10 but not capped (field: ID)
üîç [Regular Processing] 33026 (Hollywood):
   currentLayerPrimaryField: ID
   tf.value: 33026
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33026 > 10 but not capped (field: ID)
üîç [Regular Processing] 33030 (Homestead):
   currentLayerPrimaryField: ID
   tf.value: 33030
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33030 > 10 but not capped (field: ID)
üîç [Regular Processing] 33019 (Hollywood):
   currentLayerPrimaryField: ID
   tf.value: 33019
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33019 > 10 but not capped (field: ID)
üîç [Regular Processing] 33760 (Clearwater):
   currentLayerPrimaryField: ID
   tf.value: 33760
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33760 > 10 but not capped (field: ID)
üîç [Regular Processing] 32920 (Cape Canaveral):
   currentLayerPrimaryField: ID
   tf.value: 32920
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 32920 > 10 but not capped (field: ID)
üîç [Regular Processing] 34293 (Venice):
   currentLayerPrimaryField: ID
   tf.value: 34293
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 34293 > 10 but not capped (field: ID)
üîç [Regular Processing] 33434 (Boca Raton):
   currentLayerPrimaryField: ID
   tf.value: 33434
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33434 > 10 but not capped (field: ID)
üîç [Regular Processing] 33014 (Hialeah):
   currentLayerPrimaryField: ID
   tf.value: 33014
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33014 > 10 but not capped (field: ID)
üîç [Regular Processing] 33330 (Fort Lauderdale):
   currentLayerPrimaryField: ID
   tf.value: 33330
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33330 > 10 but not capped (field: ID)
üîç [Regular Processing] 33472 (Boynton Beach):
   currentLayerPrimaryField: ID
   tf.value: 33472
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33472 > 10 but not capped (field: ID)
üîç [Regular Processing] 33496 (Boca Raton):
   currentLayerPrimaryField: ID
   tf.value: 33496
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33496 > 10 but not capped (field: ID)
üîç [Regular Processing] 33478 (Jupiter):
   currentLayerPrimaryField: ID
   tf.value: 33478
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33478 > 10 but not capped (field: ID)
üîç [Regular Processing] 34108 (Naples):
   currentLayerPrimaryField: ID
   tf.value: 34108
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 34108 > 10 but not capped (field: ID)
üîç [Regular Processing] 32323 (Lanark Village):
   currentLayerPrimaryField: ID
   tf.value: 32323
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 32323 > 10 but not capped (field: ID)
üîç [Regular Processing] 34609 (Spring Hill):
   currentLayerPrimaryField: ID
   tf.value: 34609
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 34609 > 10 but not capped (field: ID)
üîç [Regular Processing] 32667 (Micanopy):
   currentLayerPrimaryField: ID
   tf.value: 32667
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 32667 > 10 but not capped (field: ID)
üîç [Regular Processing] 33010 (Hialeah):
   currentLayerPrimaryField: ID
   tf.value: 33010
   layerName: Analysis Results
‚ö†Ô∏è [Regular Processing] Score 33010 > 10 but not capped (field: ID)
[Claude Prompt Gen] Added top features list to summary for layer Analysis Results.
[Claude Prompt Gen] Finished preparing data summary. Length: 5873
[Claude] Reached point before analysis type branching. Type: brand_difference
[Claude DEBUG] First layer shapAnalysis check: { hasFirstLayer: true, hasShapAnalysis: false, shapAnalysisKeys: null }
[Claude] Loading AI persona...
[Claude] Loaded persona: Strategist (strategist)
[Claude] Preparing to call Anthropic API...
[Claude] Using analysis type: brand_difference (from: featureData)
[Claude] Normalized analysis type for persona: brand_difference
[Model Attribution] Found attribution data: false
[Enhanced Metrics] Adding endpoint-specific metrics for brand_difference
[Claude] Selected persona task instructions for 'brand_difference': FOUND
[Claude] Analysis-specific prompt length: 4121
üîç [PROMPT DEBUG] Starting prompt construction: {
  analysisType: 'brand_difference',
  persona: 'Strategist',
  hasClusterData: false,
  hasRankingContext: false,
  featureCount: 50,
  spatialFilterApplied: 'NO',
  spatialFilterCount: 0
}
üîç [PROMPT COMPONENTS] Building dynamic system prompt:
  1. Persona prompt length: 7181
  2. Field context length: 0
  3. Analysis-specific prompt length: 4121
  4. Ranking context length: 0
  5. Clustering instructions length: 0
üîç [CLAUDE API] Metadata check: {
  hasMetadata: true,
  isClustered: undefined,
  hasClusterAnalysis: false,
  clusterAnalysisLength: 0,
  metadataKeys: [ 'query', 'analysisType', 'relevantLayers', 'isContextualChat' ]
}
[Claude] System Prompt Length: 29743
[Claude] User Message Length: 15949
[Claude] Making Anthropic API call...
[Claude] System prompt length: 29743
[Claude] User message length: 15949
[Claude] Sending conversation with 1 messages
[Claude] Message roles: user
(node:99035) [DEP0169] DeprecationWarning: `url.parse()` behavior is not standardized and prone to errors that have security implications. Use the WHATWG URL API instead. CVEs are not issued for `url.parse()` vulnerabilities.
(Use `node --trace-deprecation ...` to show where the warning was created)
[Claude] Anthropic API call successful.
[Claude] AI Response Start: STRATEGIC MARKET ANALYSIS

Market share differences range from -7.2% to 0.0% across 980 markets, indicating a competitive landscape where TurboTax generally holds an advantage over H&R Block.

COMPETI...
[Claude] Extracting clickable identifiers from response...
[extractIdentifiersAndType] Received relevantLayers: [ 'unified_analysis' ]
[extractIdentifiersAndType] Received Layer Config Keys (still needed): [
  'Unknown_Service_layer_0',
  'Unknown_Service_layer_1',
  'Unknown_Service_layer_2',
  'Unknown_Service_layer_3',
  'Unknown_Service_layer_4',
  'Unknown_Service_layer_5',
  'Unknown_Service_layer_6',
  'Unknown_Service_layer_7',
  'Unknown_Service_layer_8',
  'Unknown_Service_layer_9',
  'Unknown_Service_layer_10',
  'Unknown_Service_layer_11',
  'Unknown_Service_layer_12',
  'Unknown_Service_layer_13',
  'Unknown_Service_layer_14',
  'Unknown_Service_layer_15'
]
[extractIdentifiersAndType] Results: {
  featureType: 'ZIP',
  count: 8,
  sourceLayerIdForClickable: undefined,
  sourceIdentifierFieldForClickable: undefined,
  clusterCount: 0
}
[Claude] Identifier extraction results: {
  featureType: 'ZIP',
  count: 8,
  sourceLayer: undefined,
  sourceField: undefined
}
 POST /api/claude/generate-response 200 in 22448ms