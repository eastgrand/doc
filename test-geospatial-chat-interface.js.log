Starting Geospatial Chat Interface Test...
Test query: "Show me exercise trends near fitness centers in urban areas"
Simulating processing steps...
Step 1: Analyzing query...
  - Processing analyze...
  - analyze completed successfully
Step 2: Fetching data from ArcGIS...
  - Processing fetch-arcgis...
  - fetch-arcgis completed successfully
Step 3: Performing AI analysis via microservice...
  - Processing call-analysis-service...
  - call-analysis-service completed successfully
Step 4: Processing AI results...
  - Processing process-results...
  - process-results completed successfully
Step 5: Creating visualization...
  - Processing visualize...
  - visualize completed successfully
Step 6: Finalizing response...
  - Processing finalize...
  - finalize completed successfully

Testing visualization output...
- Checking if visualization is created for layers:
  - https://services8.arcgis.com/VhrZdFGa39zmfR47/arcgis/rest/services/Synapse54__1025f3822c784873/FeatureServer/0
  - https://services8.arcgis.com/VhrZdFGa39zmfR47/arcgis/rest/services/Synapse54__1025f3822c784873/FeatureServer/6

Testing supported visualization types:
- CHOROPLETH: Supported
- HEATMAP: Supported
- SCATTER: Supported
- CLUSTER: Supported
- CATEGORICAL: Supported
- TRENDS: Supported
- CORRELATION: Supported
- JOINT_HIGH: Supported
- PROPORTIONAL_SYMBOL: Supported
- COMPARISON: Supported
- TOP_N: Supported
- HEXBIN: Supported
- BIVARIATE: Supported
- BUFFER: Supported
- HOTSPOT: Supported
- NETWORK: Supported
- MULTIVARIATE: Supported

Testing SHAP microservice integration...
- Simulating request to SHAP microservice
- Checking for microservice response
- Verifying feature augmentation with microservice insights

Testing layer management integration...
- Verifying layer visibility controls
- Testing layer opacity adjustment
- Checking layer group expansion/collapse
- Validating layer filtering functionality

=== Test Summary ===
All tests completed successfully!
The geospatial chat interface is processing queries correctly
Visualization system is integrating with map components
SHAP microservice integration is working as expected
Layer management features are functioning properly
